<%- include("partials/header.ejs") %>

<div class="position-order-contents">
    
    <div class="delivery-information">

        <form action="/checkout" method="post">
    
            <div id="delivery-info-header">Delivery Information</div>
    
            <div class="name">
                <input type="text" placeholder="First name" id="firstName" name="firstName" required>
                <input type="text" placeholder="Last name" id="lastName" name="lastName" required>
            </div>
            
                <input type="email" placeholder="Email address" id="email" name="email" required>
                <input type="text" placeholder="Street" id="street" name="street" required>
            
            <div class="cityAndState">
                <input type="text" placeholder="City" id="city" name="city" required>
                <input type="text" placeholder="State" id="state" name="state" required>
            </div>
        
            <div class="zipCodeAndCountry">
                <input type="number" name="zipcode" id="zipcode" placeholder="Zip code" required>
                <input type="text" placeholder="Country" id="country" name="country" required>
            </div>
        
            <input type="number" name="phone" id="phone" placeholder="Phone" required>
    
        </form>
        
    </div>
    
    <div class="cart-totals">
    
        <div>Cart Totals</div>
    
            <div class="prod-subtotal">
                <div>Subtotal</div>
                <div>$<%= subtotal %></div>
            </div>
        <hr>
            <div class="prod-delivery-fee">
                <div>Delivery Fee</div>
                <div>$3</div>
            </div>
        <hr>
            <div class="cart-total">
                <div><b>Total</b></div>
                <div><b>$<%= subtotal + 3 %></b></div>
            </div>
    
            <form action="/checkout" method="POST">
                <button type="submit" value="Submit">Proceed To Payment</button>
            </form>
            
    </div>

</div>

<div id="toast" style="
    display: none;
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #f44336;
    color: white;
    padding: 14px 24px;
    border-radius: 8px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    font-size: 1rem;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.4s ease;
"></div>
<!-- alert toast code which is triggered when del info is not entered -->


<%- include("partials/footer.ejs") %>

<script src="/javascripts/drop_down_menu.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
      const checkoutForm = document.querySelector('.cart-totals form');
      const deliveryForm = document.querySelector('.delivery-information form');
  
      checkoutForm.addEventListener('submit', function (e) {
        // Copy all delivery inputs
        const fields = ['firstName', 'lastName', 'email', 'street', 'city', 'state', 'zipcode', 'country', 'phone'];

        for (const name of fields) {
            const value = deliveryForm.querySelector(`[name="${name}"]`).value;
            if (!value) {
                e.preventDefault();
                showToast('Please fill out all delivery fields.');
                return;
            }
        }

        fields.forEach(name => {
          const value = deliveryForm.querySelector(`[name="${name}"]`).value;
          const hiddenInput = document.createElement('input');
          hiddenInput.type = 'hidden';
          hiddenInput.name = name;
          hiddenInput.value = value;
          checkoutForm.appendChild(hiddenInput);
        });
      });
    });
  </script>
  
  <script>
    function showToast(message) {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.style.display = "block";
        toast.style.opacity = "1";

        setTimeout(() => {
            toast.style.opacity = "0";
            setTimeout(() => {
                toast.style.display = "none";
            }, 300);
        }, 3000);
    }
</script>

</body>

</html>
